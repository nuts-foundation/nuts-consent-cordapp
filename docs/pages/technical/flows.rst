.. _nuts-consent-cordapp-technical-flows:

Supported consent flows
=======================

New Consent Request
-------------------
This flow is initiated when no *DPC* record exists yet. The flow creates a *ConsentRequestState* without any validation proofs of any party. All nodes in the Nuts network must listen to these state changes and start the approval process in *Service Space*. This will validate if the record is correct and if the patient is indeed a patient for the given Custodian. An attachment must be uploaded to the initiating node or the transaction will fail. Each party checks if the given proofs are valid and if the used public key is indeed the one used by that party (via Nuts Registry).

Accept New Consent Request
--------------------------
This is the counter party flow for the *New Consent Request* flow. It makes sure that the other node in the network perform the same contract checks as the initiating node has done.

Accept Consent Request
----------------------

Whenever a *New Consent Request* is created, other parties have to approve the new request. This is done via the *Accept Consent Request* flow. The flow adds the signatures of a care provider to the *ConsentRequestState* and starts a transaction. The transaction will then be validated by all nodes. Each care provider has to approve a *ConsentRequestState* before it can be finalised into a *DPC* record. The signatures are generated by the private key of the care provider, so any node can validate it in *service space*.

Accept Accept Consent Request
-----------------------------
This is the counter party flow for the *Accept Consent Request* flow. It makes sure that the other node in the network perform the same contract checks as the initiating node has done.